# 인터넷 네트워크

- 인터넷 통신
- IP(Internet Protocol)
- TCP, UDP
- PORT
- DNS

### 인터넷 통신

- 인터넷에서 컴퓨터 둘은 어떻게 통신할까?
- 클라이언트 - 인터넷 - 서버
- 어떤 규칙으로 어떻게 넘어갈까?

### IP(인터넷 프로토콜)

- 복잡한 인터넷망에서 hello, world라는 메세지를 미국에 있는 친구한테 보내야 함
- 최소한의 규칙이 있어야 함
- 클라이언트(나)가 IP 주소를 부여 받아야 함
  - 100.100.100.1
- 서버(친구)도 IP 주소가 있어야 함
  - 200.200.200.2
- IP
  - 지정한 IP 주소(IP Address)에 데이터 전달
  - 패킷(Packet)이라는 통신 단위로 데이터 전달
- IP 패킷 정보
  - 출발지 IP
  - 목적지 IP
  - 기타
- IP 프로토콜에 의해서 인터넷 서버들이 다 규약을 따르고 있음
- 클라이언트 패킷 전달, 서버 패킷 전달 둘 다 이뤄져야 함
- 요청, 응답할 때 서로 다른 곳으로 전달될 수도 있음

### IP 프로토콜의 한계

- 비연결성
  - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송
- 비신뢰성
  - 중간에 패킷이 사라지면?
  - 패킷이 순서대로 안 오면?
  - 같은 문제들이 해결이 안 됨
- 프로그램 구분
  - 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상이라면?

- 클라이언트는 대상 서버가 패킷을 받을 수 있는 상태인지 모름
- 1500바이트가 넘으면 끊어서 보냄
  - 1번으로 hello, 2번으로 world를 보내도 2번이 먼저 도착할 수 있음
  - IP 프로토콜만으로 해결할 수 없음
  - 이런 문제를 해결하는 게 TCP 프로토콜임

### TCP, UDP

- UDP는 문제를 해결해 주진 않지만 도움이 되는 게 있음
- 인터넷 프로토콜 스택의 4계층
  - 애플리케이션 계층(HTTP, FTP)
  - 전송 계층(TCP, UDP)
  - 인터넷 계층(IP)
  - 네트워크 인터페이스 계층
- 우리 머리에 들어오는 것...
  - 애플리케이션(웹 브라우저, 게임, 채팅 등)
  - OS
  - 네트워크 인터페이스
- 패킷: 패키지 + 버킷

- IP 패킷 안에 TCP와 관련된 정보가 들어감
  - TCP/IP 패킷 정보
    - 출발지 PORT
    - 목적지 PORT
    - 전송 제어와 관련된 정보
    - 순서와 관련된 정보
    - 검증과 관련된 정보
  - IP만으로 해결이 안 됐던 순서 제어 문제 등이 해결됨

- TCP 특징
  - 전송 제어 프로토콜(Transmission Control Protocol)
  - 연결 지향
    - TCP 3 way handshake(가상 연결)
  - 데이터 전달 보증
  - 순서 보장
  - 신뢰할 수 있는 프로토콜
  - 현재는 대부분 TCP 사용

- TCP 3 way handshake
  - 1번
    - 클라이언트에서 SYN이라는 메세지를 보냄
  - 2번
    - 서버에서 SYN + ACK라는 메세지를 보냄
  - 3번
    - 클라이언트에서 ACK라는 메세지를 보냄
  - 4번
    - 연결 되면 바로 데이터를 전송함
  - 참고
    - 3번 ACK와 함께 데이터를 전송할 수 있음
  - 물리적인 연결은 아님
  - 개념적, 논리적 연결
  - 나를 위한 전용 랜선이 보장되는 게 아님

- 데이터 전달 보증
  - TCP가 붙으면 클라이언트에서 데이터를 전송했을 때, 서버에서 데이터 잘 받았다고 메세지를 보냄
  - 아무 응답이 없으면 문제가 있다고 판단할 수 있음

- 순서 보장
  - 1번, 2번, 3번 순서로 보냄
  - 서버에 1번, 3번, 2번로 옴
  - 그러면 다 버리고 패킷 2번부터 다시 보내라고 함
  - 물론 서버에서 더 최적화할 수 있음

- UDP
  - 사용자 데이터그램 프로토콜(User Datagram Protocol)
  - 하얀 도화지에 비유(기능이 거의 없음)
  - 연결지향 X, 데이터 전달 보증 X, 순서 보장 X
  - 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠름
  - 내 PC는 IP가 하나 할당되어 있기에, 패킷이 여러 개 옴
  - 이때 어떤 게 게임용 패킷이고, 어떤 게 음악용 패킷인지 구분할 때 필요
  - TCP는 최적화할 수 없음(정확히는 손을 못 댐)
  - 최적화하고 싶으면 UDP를 만지면 됨
  - 정리
    - IP와 거의 같음
    - 추가로 PORT, 체크섬
    - 애플리케이션에서 추가 작업 필요
